if (self.CavalryLogger) { CavalryLogger.start_js(["NP5J2ml"]); }

__d("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer$normalization.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,b,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"uri_token",storageKey:null}],type:"Page",abstractKey:null}],storageKey:null},d=[b];return{kind:"SplitOperation",metadata:{},name:"CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer$normalization",selections:[{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachment",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[a,{alias:"photo_image",args:[{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"sizing",value:"cover-fill"},{kind:"Literal",name:"width",value:500}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isMedia"},{alias:null,args:null,kind:"ScalarField",name:"is_playable",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},b,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"binary_cdn_uri",storageKey:null}],type:"PhotoEncoding3D",abstractKey:null}],storageKey:null},b,c],type:"Photo",abstractKey:null},{kind:"InlineFragment",selections:[b,c],type:"Video",abstractKey:null},{kind:"InlineFragment",selections:d,type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:d,type:"GenericAttachmentMedia",abstractKey:null},{kind:"InlineFragment",selections:d,type:"MontageImage",abstractKey:null},{kind:"InlineFragment",selections:d,type:"MontageVideo",abstractKey:null}],storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"is_prod_eligible",storageKey:null}],type:"StoryAttachmentStyleRendererUnion",abstractKey:"__isStoryAttachmentStyleRendererUnion"}]}}();e.exports=a}),null);
__d("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};b=[b,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,b,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"uri_token",storageKey:null}],type:"Page",abstractKey:null}],storageKey:null}];return{argumentDefinitions:[{kind:"RootArgument",name:"scale"}],kind:"Fragment",metadata:null,name:"CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer",selections:[{args:null,kind:"FragmentSpread",name:"useCometFeedStoryAttachmentMatchDebugger_storyAttachmentStyleRendererUnion"},{alias:null,args:null,concreteType:"StoryAttachment",kind:"LinkedField",name:"attachment",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"media",plural:!1,selections:[a,{alias:"photo_image",args:[{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"sizing",value:"cover-fill"},{kind:"Literal",name:"width",value:500}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"accessibility_caption",storageKey:null}],type:"Photo",abstractKey:null},{args:null,kind:"FragmentSpread",name:"CometRemote3DPhotoViewer_photo"},{kind:"InlineDataFragmentSpread",name:"getCometMediaURL_media",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_playable",storageKey:null},{kind:"InlineFragment",selections:b,type:"Photo",abstractKey:null},{kind:"InlineFragment",selections:b,type:"Video",abstractKey:null}]}],storageKey:null}],storageKey:null}],type:"StoryAttachment3DPhotoStyleRenderer",abstractKey:null}}();e.exports=a}),null);
__d("CometRemote3DPhotoViewerRenderer_renderer$normalization.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{kind:"SplitOperation",metadata:{},name:"CometRemote3DPhotoViewerRenderer_renderer$normalization",selections:[{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"binary_cdn_uri",storageKey:null}],type:"PhotoEncoding3D",abstractKey:null}],storageKey:null},a],storageKey:null}]}}();e.exports=a}),null);
__d("CometRemote3DPhotoViewerRenderer_renderer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometRemote3DPhotoViewerRenderer_renderer",selections:[{alias:null,args:null,concreteType:"Photo",kind:"LinkedField",name:"photo",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometRemote3DPhotoViewer_photo"}],storageKey:null}],type:"XFBCometImmersive3DPhotoRenderer",abstractKey:null};e.exports=a}),null);
__d("CometRemote3DPhotoViewer_photo.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometRemote3DPhotoViewer_photo",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"immersive_photo_encodings",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"projection_type",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"binary_cdn_uri",storageKey:null}],type:"PhotoEncoding3D",abstractKey:null}],storageKey:null}],type:"Photo",abstractKey:null};e.exports=a}),null);
__d("Comet3DPhotoLoadingOverlay.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){a=a.isVisible;return h.jsx("div",{className:"orwu60u2 e4zzj2sf art1omkt jowmb856 py2didcb rk01pc8j kfkz5moi pmk7jnqg hzruof5a rdkrh8wx"+(a?"":" b5wmifdl"),children:h.jsx("div",{})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometRemote3DPhotoViewer.react",["Comet3DPhotoLoadingOverlay.react","CometFeedStoryViewportMaxHeightMediaLayout.react","CometRelay","CometRemote3DPhotoViewer_photo.graphql","clearTimeout","cr:1298198","orEmptyArray","react","recoverableViolation","setTimeout","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useCallback,k=e.useEffect,l=e.useRef,m=e.useState,n={content:{height:"datstx6m",position:"l9j0dhe7"},image:{bottom:"i09qtzwb",end:"n7fi1qx3",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4"},overlays:{bottom:"i09qtzwb",end:"n7fi1qx3",pointerEvents:"hzruof5a",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4"},photoContainer:{position:"l9j0dhe7"},root:{borderBottom:"linmgsc8",borderTop:"opwvks06",boxShadow:"g81y0s2s"}};function a(a){var e,f,g=a.fallback,o=d("CometRelay").useFragment(h!==void 0?h:h=b("CometRemote3DPhotoViewer_photo.graphql"),a.photo),p=m(!1),q=p[0],r=p[1];p=m(!1);var s=p[0],t=p[1],u=l(null);k(function(){u.current=c("setTimeout")(function(){t(!0)},2e3);return function(){u.current!=null&&c("clearTimeout")(u.current)}},[]);p=j(function(){r(!0)},[r]);s=!s||!q;q=c("orEmptyArray")(o==null?void 0:o.immersive_photo_encodings);o=q.find(function(a){return(a==null?void 0:a.projection_type)==="three_d"});if(a.glbFileURI==null&&o==null){c("recoverableViolation")("3D photo does not have three_d encoding","comet_feed");return g}a=a.glbFileURI!=null?a.glbFileURI:(q=o==null?void 0:o.binary_cdn_uri)!=null?q:"";o=(q=o==null?void 0:o.id)!=null?q:"";q=(q=g.props.src)!=null?q:"";e=(e=g.props.width)!=null?e:0;f=(f=g.props.height)!=null?f:0;(e===0||f===0)&&c("recoverableViolation")("null fallback size was provided for 3d photo","comet_feed");var v=e===0||f===0?{aspectRatio:1,height:1,width:1}:{aspectRatio:e/f,height:f,width:e};v=v.aspectRatio;var w=a!=null&&b("cr:1298198")!=null?i.jsxs("div",{className:c("stylex")(n.photoContainer),children:[i.jsx(b("cr:1298198"),{aspectRatio:v,fallbackURI:q,fileURI:a,onLoad:p,photoID:o}),i.jsx("div",{className:c("stylex")(n.overlays),children:i.jsx(c("Comet3DPhotoLoadingOverlay.react"),{isVisible:s})})]}):g;return i.jsx("div",{className:c("stylex")(n.root),children:i.jsx(c("CometFeedStoryViewportMaxHeightMediaLayout.react"),{backgroundColor:null,mediaHeight:f,mediaWidth:e,children:function(a){return i.jsx("div",{className:c("stylex")(n.content,a),children:i.jsx("div",{className:c("stylex")(n.image),children:w})})}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useWebGLContextVisibility",["HiddenSubtreePassiveContext","intersectionObserverEntryIsIntersecting","react","useIntersectionObserver"],(function(a,b,c,d,e,f,g){"use strict";d("react");var h=d("react").useContext;function a(a,b){b===void 0&&(b=Object.freeze({}));var d=h(c("HiddenSubtreePassiveContext")),e=function(b){var e=d.getCurrentState().hiddenOrBackgrounded_FIXME;c("intersectionObserverEntryIsIntersecting")(b)?a(!0):e||a(!1)};return c("useIntersectionObserver")(e,babelHelpers["extends"]({root:null,rootMargin:{},threshold:0},b))}g["default"]=a}),98);
__d("CometFeedStory3DPhotoAttachmentStyle.react",["CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql","CometImage.react","CometPressable.react","CometRelay","CometRemote3DPhotoViewer.react","getCometMediaURL","gkx","react","stylex","unrecoverableViolation","useCometFeedStoryAttachmentMatchDebugger","useWebGLContextVisibility"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useMemo,k=e.useState,l={image:{bottom:"i09qtzwb",end:"n7fi1qx3",position:"pmk7jnqg",start:"j9ispegn",top:"kr520xx4"},mediaPressed:{backgroundColor:"r9n4d945"},wrapper:{position:"l9j0dhe7",width:"k4urcfbm"}},m=c("gkx")("708253");function a(a){a=d("CometRelay").useFragment(h!==void 0?h:h=b("CometFeedStory3DPhotoAttachmentStyle_styleTypeRenderer.graphql"),a.styleTypeRenderer);c("useCometFeedStoryAttachmentMatchDebugger")(a);var e=k(!1),f=e[0];e=e[1];e=c("useWebGLContextVisibility")(e,{rootMargin:{bottom:2e3,top:2e3}});a=a.attachment;var g=a==null?void 0:a.media;if(g==null)throw c("unrecoverableViolation")("media attachment cannot be null in CometFeedStory3DPhotoAttachment","comet_feed");var n=(a=(a=g.photo_image)==null?void 0:a.uri)!=null?a:"",o=(a=g.accessibility_caption)!=null?a:"",p=(a=(a=g.photo_image)==null?void 0:a.height)!=null?a:0,q=(a=(a=g.photo_image)==null?void 0:a.width)!=null?a:0,r=c("getCometMediaURL")(g,null),s=j(function(){return i.jsx(c("CometImage.react"),{alt:o,height:p,src:n,width:q,xstyle:l.image})},[o,p,n,q]);a=j(function(){var a=i.jsx(c("CometRemote3DPhotoViewer.react"),{fallback:s,photo:g});return i.jsx(c("CometPressable.react"),{hideHoverOverlay:!0,linkProps:{rel:m?void 0:"theater",url:r},overlayPressedStyle:l.mediaPressed,style:{display:"block"},children:a})},[s,g,r]);return i.jsx("div",{className:c("stylex")(l.wrapper),ref:e,children:f?a:s})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("createWebGL3DPhotoProgram",["CometWebGLProgram"],(function(a,b,c,d,e,f,g){"use strict";var h="\nattribute vec3 a_position;\nattribute vec2 a_texcoord_0;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nvarying vec2 v_texcoord_0;\n\nvoid main() {\n  v_texcoord_0 = a_texcoord_0;\n  gl_Position = projectionMatrix * viewMatrix * vec4(a_position, 1.0);\n}\n",i='\nprecision mediump float;\n\nvarying vec2 v_texcoord_0;\nuniform sampler2D u_texture_0;\n\nvoid main() {\n  // LOD refers to "level of detail" and is used for mipmap filtering.\n  // A positive LOD bias samples closer to the less detailed mipmap level,\n  // and a negative LOD bias samples closer to the more detailed mipmap level.\n  const float kLodBias = 0.0;\n  gl_FragColor = texture2D(u_texture_0, v_texcoord_0, kLodBias);\n}\n';function a(a){var b=new(c("CometWebGLProgram"))(a);return b.addShader(h,a.VERTEX_SHADER).addShader(i,a.FRAGMENT_SHADER).compile().setUniformDefaults({projectionMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],viewMatrix:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]})}g["default"]=a}),98);
__d("createMeshesFromGLTF",["CometWebGLMesh","CometWebGLTexture","Promise","createWebGL3DPhotoProgram"],(function(a,b,c,d,e,f,g){"use strict";var h={POSITION:"a_position",TEXCOORD_0:"a_texcoord_0"};function a(a,d){var e=[],f=c("createWebGL3DPhotoProgram")(a),g=[],j=d.getMeshes();for(var j=j,k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var m;if(k){if(l>=j.length)break;m=j[l++]}else{l=j.next();if(l.done)break;m=l.value}m=m;m=m.primitives;for(var m=m,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}p=p;var q=p.attributes,r=[],s=Infinity,t=0;q=Object.entries(q);for(var u=0;u<q.length;u++){var v=q[u],w=v[0];v=v[1];if(typeof v==="number"){v=d.getAccessor(v);var x=d.getBufferView(v.bufferView);x.byteOffset<s&&(s=x.byteOffset);x.byteOffset+x.byteLength>t&&(t=x.byteOffset+x.byteLength);v=v.byteOffset!=null?v.byteOffset:0;r.push({byteOffset:x.byteOffset+v,name:w})}}r.sort(i);var y=new(c("CometWebGLMesh"))(a,f,{interleaved:!1});x=d.getBinarySource();for(var v=0;v<r.length;v++){w=r[v];if(w.name in h){q=w.byteOffset-s;u={offset:q};y.addAttribute(h[w.name],u)}}y.bufferData(new Float32Array(x.buffer,x.byteOffset+s,(t-s)/4));p.indices!=null&&y.bufferIndex(d.getDataViewForAccessor(p.indices));if(p.material!=null){q=d.getMaterial(p.material);var z=q==null?void 0:(w=q.pbrMetallicRoughness)==null?void 0:(u=w.baseColorTexture)==null?void 0:u.index;z!=null&&(function(){var e=d.getTexture(z),f=d.getImage(e.source),h=new(c("CometWebGLTexture"))(a,{generateMipmaps:!0});g.push(new(b("Promise"))(function(a,b){f.onload=function(){h.setSource(f),a()},f.onerror=function(){b()}}));y.setUniform("u_texture_0",h)})()}e.push(y)}}return b("Promise").all(g).then(function(){return e})}function i(a,b){return a.byteOffset-b.byteOffset}g["default"]=a}),98);
__d("glVec3CrossProduct",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}f["default"]=a}),66);
__d("glMatrixLookingAtTarget",["glVec3CrossProduct"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){b=[a[0]-b[0],a[1]-b[1],a[2]-b[2]];var d=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=d;b[1]/=d;b[2]/=d;d=c("glVec3CrossProduct")([0,1,0],b);var e=c("glVec3CrossProduct")(b,d);return[d[0],d[1],d[2],0,e[0],e[1],e[2],0,b[0],b[1],b[2],0,a[0],a[1],a[2],1]}g["default"]=a}),98);
__d("GLTFResource",["orEmptyArray","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=[],this.$2=[],this.$3=null,this.$4=null,this.$5=[],this.$6=[],this.$7=[],this.$8=[]}var b=a.prototype;b.addBinarySource=function(a,b,c){this.$3=new Uint8Array(a,b,c)};b.useJSON=function(a){var b;this.$4=(b=a.extras)!=null?b:Object.freeze({});this.$1=c("orEmptyArray")(a.accessors);this.$2=c("orEmptyArray")(a.bufferViews);this.$5=c("orEmptyArray")(a.images);this.$6=c("orEmptyArray")(a.materials);this.$7=c("orEmptyArray")(a.meshes);this.$8=c("orEmptyArray")(a.textures)};b.getBinarySource=function(){if(this.$3==null)throw c("unrecoverableViolation")("attempted to access binary source before it was set","webgl");return this.$3};b.hasBinarySource=function(){return this.$3!=null};b.getAccessor=function(a){a=this.$1[a];if(a==null)throw new(c("unrecoverableViolation"))("accessor index out of range","webgl");return a};b.getBufferView=function(a){a=this.$2[a];if(a==null)throw new(c("unrecoverableViolation"))("buffer view index out of range","webgl");return a};b.getExtras=function(){return this.$4};b.getMaterial=function(a){a=this.$6[a];if(a==null)throw new(c("unrecoverableViolation"))("material index out of range","webgl");return a};b.getMeshes=function(){return this.$7};b.getTexture=function(a){a=this.$8[a];if(a==null)throw new(c("unrecoverableViolation"))("texture index out of range","webgl");return a};b.getDataViewForAccessor=function(a){a=this.$1[a];if(a==null)throw new(c("unrecoverableViolation"))("accessor index out of range","webgl");var b=this.$2[a.bufferView];if(b==null)throw new(c("unrecoverableViolation"))("buffer view index out of range","webgl");if(b.buffer!==0)throw new(c("unrecoverableViolation"))("external gltf buffers are not currently supported","webgl");var d=this.$3;if(d==null)throw new(c("unrecoverableViolation"))("attempted to get an accessor before loading binary data","webgl");var e=d.byteOffset+b.byteOffset;switch(a.componentType){case 5120:return new Int8Array(d.buffer,e,b.byteLength);case 5121:return new Uint8Array(d.buffer,e,b.byteLength);case 5122:return new Int16Array(d.buffer,e,b.byteLength/2);case 5123:return new Uint16Array(d.buffer,e,b.byteLength/2);case 5124:return new Int32Array(d.buffer,e,b.byteLength/4);case 5125:return new Uint32Array(d.buffer,e,b.byteLength/4);case 5126:return new Float32Array(d.buffer,e,b.byteLength/4);default:throw new(c("unrecoverableViolation"))("unsupported gl component type","webgl")}};b.getImage=function(a){a=this.$5[a];var b=this.getBufferView(a.bufferView),c=this.getBinarySource();c=new Uint8Array(c.buffer,c.byteOffset+b.byteOffset,b.byteLength);b=new Blob([c],{type:a.mimeType});c=URL.createObjectURL(b);a=new Image();a.src=c;return a};return a}();g["default"]=a}),98);
__d("GLTFTypesValidator",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){throw new(c("unrecoverableViolation"))("unrecoverable incorrectly formatted JSON ".concat(a),"webgl")}function i(a){a===void 0&&h("GLTFAccessor undefined"),s(a.bufferView,!0,"GLTFAccessor.bufferView",0),s(a.byteOffset,!1,"GLTFAccessor.byteOffset",0),s(a.componentType,!0,"GLTFAccessor.componentType",5120,5126),s(a.count,!0,"GLTFAccessor.count",1),a.type!==void 0&&(a.type!=="SCALAR"&&a.type!=="VEC2"&&a.type!=="VEC3"&&a.type!=="VEC4"&&h("GLTFAccessor malformed"))}function j(a){k(a,!0,"GLTFAccessor");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;i(d)}}function k(a,b,c){if(a===void 0)if(b)h("Array<".concat(c).concat("> undefined"));else return;else a.length===0&&h("Array<".concat(c).concat("> length=0"))}function a(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="boolean"&&h(c.concat(" not a boolean"))}function l(a){a===void 0&&h("GLTFBuffer undefined"),s(a.byteLength,!0,"GLTFBuffer.byteLength",1)}function m(a){s(a.buffer,!0,"GLTFBufferView.buffer",0),s(a.byteOffset,!0,"GLTFBufferView.byteOffset",0),s(a.byteLength,!0,"GLTFBufferView.byteLength",0)}function n(a){k(a,!1,"GLTFBufferView");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;m(d)}}function o(a){k(a,!1,"GLTFBuffer");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;l(d)}}function p(a){a!==void 0&&(a.FB_PHOTO_3D_DATA!==void 0?(a.FB_PHOTO_3D_DATA.hFov!==void 0&&s(a.FB_PHOTO_3D_DATA.hFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.hFov"),a.FB_PHOTO_3D_DATA.vFov!==void 0&&s(a.FB_PHOTO_3D_DATA.vFov,!1,"GLTFExtras.FB_PHOTO_3D_DATA.vFov")):h("GLTFExtras undefined"))}function b(a){a!==void 0?(j(a.accessors),o(a.buffers),n(a.bufferViews),p(a.extras),r(a.images),u(a.materials),w(a.meshes),B(a.textures)):h("GLTFBody undefined")}function q(a){a===void 0&&h("GLTFImage undefined"),z(a.mimeType,!0,"GLTFImage.mimeType"),s(a.bufferView,!0,"GLTFImage.bufferView",0)}function r(a){k(a,!1,"GLTFImage");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;q(d)}}function s(a,b,c,d,e){d===void 0&&(d=Number.MIN_SAFE_INTEGER);e===void 0&&(e=Number.MAX_SAFE_INTEGER);if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a==="number"?(a<d||a>e)&&h(c.concat(" out of range")):h(c.concat(" not an integer"))}function t(a){a===void 0&&h("GLTFMaterial undefined"),a.pbrMetallicRoughness!==void 0&&(a.pbrMetallicRoughness.baseColorTexture!==void 0&&s(a.pbrMetallicRoughness.baseColorTexture.index,!1,"GLTFMaterial.pbrMetallicRoughness.baseColorTexture.index",0))}function u(a){k(a,!1,"GLTFMaterial");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;t(d)}}function v(a){a===void 0&&h("GLTFMesh undefined"),y(a.primitives)}function w(a){k(a,!0,"GLTFMesh");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;v(d)}}function x(a){a===void 0&&h("GLTFPrimitive undefined");for(var b in a.attributes)Object.prototype.hasOwnProperty.call(a.attributes,b)&&(b==="POSITION"||b==="TEXCOORD_0"||b==="TEXCOORD_1"?s(a.attributes[b],!0,"GLTFPrimitives.attributes[".concat(b).concat("]"),0):h("GLTFPrimitive malformed"));s(a.indices,!1,"GLTFPrimitives.indicies",0);s(a.material,!1,"GLTFPrimitives.material",0)}function y(a){a===void 0&&h("GLTFPrimatives undefined");k(a,!0,"GLTFPrimitive");for(var b=0;b<a.length;b++){var c=a[b];x(c)}}function z(a,b,c){if(a===void 0)if(b)h(c.concat(" undefined"));else return;typeof a!=="string"&&h(c.concat(" not a string"))}function A(a){a===void 0&&h("GLTFTexture undefined"),s(a.sampler,!0,"GLTFTexture.sampler",0),s(a.source,!0,"GLTFTexture.source",0)}function B(a){k(a,!0,"GLTFTexture");if(a!==void 0)for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;A(d)}}g.throwBadFormat=h;g.validateAccessor=i;g.validateAccessors=j;g.validateArray=k;g.validateBoolean=a;g.validateBuffer=l;g.validateBufferView=m;g.validateBufferViews=n;g.validateBuffers=o;g.validateExtras=p;g.validateGLTFBodyJSON=b;g.validateImage=q;g.validateImages=r;g.validateInteger=s;g.validateMaterial=t;g.validateMaterials=u;g.validateMesh=v;g.validateMeshes=w;g.validatePrimitive=x;g.validatePrimitives=y;g.validateString=z;g.validateTexture=A;g.validateTextures=B}),98);
__d("extractUTF8StringFromBuffer",["EndianAwareDataReader","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a>127}function i(a){return a>=192&&a<=223}function j(a){return a>=224&&a<=239}function k(a){return a>=240&&a<=247}function a(a,b,d){if(b+d>a.byteLength)throw new(c("unrecoverableViolation"))("offset and length exceed ArrayBuffer bounds","webgl");if("TextDecoder"in window){var e=new TextDecoder("utf-8"),f=new Uint8Array(a,b,d);return e.decode(f)}e=new(c("EndianAwareDataReader"))(a.slice(b,b+d),!1);f=[];while(e.canReadU8()){a=e.readU8();if(h(a))if(i(a)){if(!e.canReadU8())throw new(c("unrecoverableViolation"))("incomplete two-byte utf8 sequence","webgl");b=e.readU8();a=(a&31)<<6|b&63}else if(j(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;if(d==null||b==null)throw new(c("unrecoverableViolation"))("incomplete three-byte utf8 sequence","webgl");a=(a&15)<<12|(d&63)<<6|b&63}else if(k(a)){d=e.canReadU8()?e.readU8():null;b=e.canReadU8()?e.readU8():null;var g=e.canReadU8()?e.readU8():null;if(d==null||b==null||g==null)throw new(c("unrecoverableViolation"))("incomplete four-byte utf8 sequence","webgl");a=(a&7)<<18|(d&63)<<12|(b&63)<<6|g&63}else throw new(c("unrecoverableViolation"))("unknown utf8 start sequence","webgl");if(a<=65535)f.push(String.fromCharCode(a));else if(a<=1114111)a-=65536,f.push(String.fromCharCode(a>>10|55296)),f.push(String.fromCharCode(a&1023|56320));else throw new(c("unrecoverableViolation"))("codepoint is beyond ","webgl")}return f.join("")}g["default"]=a}),98);
__d("parseGLBResource",["GLTFResource","GLTFTypesValidator","extractUTF8StringFromBuffer","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=1179937895;function a(a){var b=new DataView(a);if(b.getUint32(0,!0)!==h)throw new(c("unrecoverableViolation"))("invalid GLB magic number","webgl");if(b.getUint32(4,!0)!==2)throw new(c("unrecoverableViolation"))("unsupported GLB version number","webgl");var e=b.getUint32(8,!0);if(e>a.byteLength)throw new(c("unrecoverableViolation"))("glb buffer is shorter than declared byte length","webgl");var f=new(c("GLTFResource"))(),g=12;while(g<e){var i=b.getUint32(g,!0),j=b.getUint32(g+4,!0);switch(j){case 1313821514:j=c("extractUTF8StringFromBuffer")(a,g+8,i);var k="";try{k=JSON.parse(j)}catch(a){throw new(c("unrecoverableViolation"))("failed to parse glTF JSON","webgl",a)}d("GLTFTypesValidator").validateGLTFBodyJSON(k);f.useJSON(k);break;case 5130562:f.addBinarySource(a,g+8,i);break;default:throw new(c("unrecoverableViolation"))("unexpected GLB section label","webgl")}g+=i+8}return f}g["default"]=a}),98);
__d("useGLBLoadAndParse",["parseGLBResource","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useEffect,i=b.useState;function a(a){var b=i(null),d=b[0],e=b[1];h(function(){var b=!1;c("promiseDone")(window.fetch(a).then(function(a){return a.arrayBuffer()}).then(function(a){if(b)return;a=c("parseGLBResource")(a);e(a)})["catch"](function(){e(null)}));return function(){b=!0}},[a]);return d}g["default"]=a}),98);
__d("useGLTFDerivedFOV",["react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react").useMemo,i=1,j=.508015513,k=.666488587,l=.925,m=Object.freeze({landscape:-.14,portrait:-.124}),n=Object.freeze({landscape:-.124,portrait:-.112}),o=Object.freeze({landscape:.96,portrait:.8}),p=Object.freeze({landscape:.6,portrait:.7});function a(a){var b=h(function(){var b;b=(b=a==null?void 0:(b=a.getExtras())==null?void 0:(b=b.FB_PHOTO_3D_DATA)==null?void 0:b.vFov)!=null?b:k;return b*l},[a]),c=h(function(){var b;b=(b=a==null?void 0:(b=a.getExtras())==null?void 0:(b=b.FB_PHOTO_3D_DATA)==null?void 0:b.hFov)!=null?b:j;return b*l},[a]),d=h(function(){var a=.1,d=1e3,e=1/Math.tan(b/2),f=c/b;return[e/f,0,0,0,0,e,0,0,0,0,(a+d)/(a-d),-1,0,0,a*d*2/(a-d),0]},[c,b]),e=h(function(){var a=c>b?"landscape":"portrait",d=m[a],e=n[a];return[Math.tan(c/2)*i*d,Math.tan(b/2)*i*e,1-o[a],p[a]]},[c,b]),f=e[0],g=e[1],q=e[2];e=e[3];return{hFov:c,maxHorizontalAngle:f,maxVerticalAngle:g,projectionMatrix:d,targetInteractionWeightHorizontal:q,targetScrollWeightVertical:e,vFov:b}}g["default"]=a}),98);
__d("Comet3DPhotoViewer.react",["fbt","CometFeedStoryImmersiveMediaMouseOverlay.react","CometLazyPopoverTrigger.react","ConstUriUtils","JSResourceForInteraction","Matrices","UserAgent","clearTimeout","createMeshesFromGLTF","gkx","glMatrixLookingAtTarget","mergeRefs","promiseDone","react","setTimeout","useFrameTiming","useGLBLoadAndParse","useGLContext","useGLTFDerivedFOV","useResizeObserver","useThrottled","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i=d("react");b=d("react");var j=b.useCallback,k=b.useEffect,l=b.useMemo,m=b.useRef,n=b.useState,aa=c("JSResourceForInteraction")("CometFeedStory3DPhotoContextMenu.react").__setRef("Comet3DPhotoViewer.react"),o=1,p=.01,ba=.005,ca=.1,q=.06,da=.12;function a(a){var b=a.aspectRatio,e=a.fallbackURI,f=a.fileURI,g=a.onLoad;a=a.photoID;var r=c("gkx")("678680"),s=n(!1),t=s[0],u=s[1],v=m(null),w=i.createRef();s=n(1024);var x=s[0],y=s[1];s=c("useGLContext")(x,Math.ceil(x/b),{expand:!0});var z=s[0],A=s[1];x=c("useFrameTiming")();var B=x[0],C=c("useGLBLoadAndParse")(f);b=n([]);var D=b[0],ea=b[1];k(function(){if(z==null||C==null)return;var a=!1;c("promiseDone")(c("createMeshesFromGLTF")(z,C).then(function(b){if(a)return;ea(b);g&&g();B(U)}));return function(){a=!0}},[z,C,g]);s=c("useGLTFDerivedFOV")(C);var E=s.hFov,F=s.maxHorizontalAngle,G=s.maxVerticalAngle,H=s.projectionMatrix,I=s.targetInteractionWeightHorizontal,J=s.targetScrollWeightVertical,K=s.vFov,L=j(function(){if(z==null||D.length===0)return;z.enable(z.DEPTH_TEST);z.clear(z.COLOR_BUFFER_BIT|z.DEPTH_BUFFER_BIT);z.enable(z.BLEND);z.blendFunc(z.SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA);for(var a=D,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.program.use();d.draw()}},[D,z]),fa=function(){c("clearTimeout")(v.current),v.current=c("setTimeout")(function(){u(!0)},3e3)};x=function(){t&&u(!1),fa()};var M=c("useThrottled")(x,100),N=c("useVisibilityObserver")({onVisible:function(){c("clearTimeout")(v.current),v.current=c("setTimeout")(function(){u(!0)},3e3)}});k(function(){return function(){c("clearTimeout")(v.current)}},[]);var O=m([0,0]),P=m(1),Q=m(1),R=m([0,0]),S=m([0,0]),T=m(0),U=j(function(a){if(z==null)return;if(a!=null){if(T.current!==0){var b=Math.min(a-T.current,50);b=Math.max(Math.min(ba*b,1),0);var d=R.current,e=d[0];d=d[1];var f=S.current,g=f[0];f=f[1];S.current=[g+b*(e-g),f+b*(d-f)];g=P.current;f=Q.current;Q.current=f+b*(g-f);(Math.abs(S.current[0]-e)>p||Math.abs(S.current[1]-d)>p||Math.abs(Q.current-g)>p)&&B(U)}T.current=a}b=Q.current;f=K*da*(2*b-1);e=(1-2*b)*G;d=S.current;g=d[0];a=d[1];d=Math.sin(g*Math.PI*.5);g=Math.sin(a*Math.PI*.5);a=K*q*g;var h=E*q*d;d=-d*F;g=-g*G;b=Math.pow(b+.16,3)/(Math.pow(b+.16,3)+Math.pow(1-(b+.16),3))-.9;a=-(a+f);f=-h;h=o-b*ca;b=[0+h*Math.cos(a)*Math.sin(f),0+h*Math.sin(a),-o+h*Math.cos(a)*Math.cos(f)];h=[-(I*d),-(e*J+g*(1-J)),-o];a=c("glMatrixLookingAtTarget")(b,h);f=c("Matrices").invertMat4(a);for(var d=D,e=Array.isArray(d),g=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(g>=d.length)break;b=d[g++]}else{g=d.next();if(g.done)break;b=g.value}h=b;h.setUniform("viewMatrix",f);h.setUniform("projectionMatrix",H)}L()},[L,z,E,F,G,D,H,B,I,J,K]);k(function(){var a=w==null?void 0:w.current;if(a==null)return;a=a.clientWidth;a!=null&&y(a)},[w]);var V=c("useResizeObserver")(function(a){y(Math.floor(a.width))}),W=j(function(){if(z==null)return;var a=z.canvas,b=0,c=0;while(a!=null)b+=a instanceof HTMLElement?a.offsetLeft:0,c+=a instanceof HTMLElement?a.offsetTop:0,a=a instanceof HTMLElement?a.offsetParent:null;O.current=[b,c]},[O,z]),X=j(function(){var a;if(z==null)return;W();var b=window.innerHeight,c=z.canvas.clientHeight;b=b+c;a=O.current[1]-((a=(a=document.scrollingElement)==null?void 0:a.scrollTop)!=null?a:0)+c;c=a/b;P.current=c;if(c<0||c>1)return;B(U)},[O,z,B,U,W]);b=j(function(a){if(z==null)return;W();var b=a.pageX;a=a.pageY;b=b-O.current[0];a=a-O.current[1];b=2*b/z.canvas.clientWidth-1;a=1-2*a/z.canvas.clientHeight;R.current=[b,a];M();if(b<-1||a<-1||b>1||a>1)return;B(U)},[z,R,B,M,U,W]);k(function(){document.addEventListener("scroll",X);U();return function(){document.removeEventListener("scroll",X)}},[U,X]);var Y,Z;if(a!=null){Y=(s=d("ConstUriUtils").getUri("/intern/compphoto/x3d/3dphoto_console"))==null?void 0:(x=s.setDomain("our.intern.facebook.com"))==null?void 0:(s=x.setProtocol("https"))==null?void 0:(x=s.addQueryParam("ent_id",a))==null?void 0:x.toString();Z=(s=d("ConstUriUtils").getUri("/intern/compphoto/x3d/"+a+"/depth"))==null?void 0:(x=s.setDomain("our.intern.facebook.com"))==null?void 0:(a=x.setProtocol("https"))==null?void 0:a.toString()}s=n(0);x=s[0];var ga=s[1];a=n(0);s=a[0];var ha=a[1],ia=function(a,b){var d=/^a$/i.test(a.target.nodeName||""),e=c("UserAgent").isPlatform("Mac OS X")?a.metaKey:a.ctrlKey;d=!d&&r&&e;d&&(ga(a.nativeEvent.offsetX),ha(a.nativeEvent.offsetY),a.preventDefault(),b())};a=l(function(){return c("mergeRefs")(A,N,w,V)},[A,N,w,V]);var $=i.jsx("div",{onMouseMove:b,ref:a,children:i.jsx(c("CometFeedStoryImmersiveMediaMouseOverlay.react"),{descriptionFbt:h._("Move your mouse to view the photo in 3D"),isActive:t,showClick:!1})});b=i.jsx(c("CometLazyPopoverTrigger.react"),{popoverProps:{consoleURL:Y,depthURL:Z,fallbackImgURL:e,fileURL:f,mouseClickX:x,mouseClickY:s},popoverResource:aa,children:function(a,b){return i.jsx("div",{className:"kr520xx4 j9ispegn pmk7jnqg n7fi1qx3 i09qtzwb",onContextMenu:function(a){ia(a,b)},ref:a,children:$})}});return r?b:$}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometRemote3DPhotoViewerRenderer.react",["CometRelay","CometRemote3DPhotoViewer.react","CometRemote3DPhotoViewerRenderer_renderer.graphql","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");function a(a){var e=a.fallback,f=a.glbFileURI;a=a.renderer;a=d("CometRelay").useFragment(h!==void 0?h:h=b("CometRemote3DPhotoViewerRenderer_renderer.graphql"),a);a=a==null?void 0:a.photo;return a==null?e:i.jsx(c("CometRemote3DPhotoViewer.react"),{fallback:e,glbFileURI:f,photo:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);